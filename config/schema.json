{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Client Configuration Schema",
  "type": "object",
  "required": ["client", "infrastructure", "email"],
  "properties": {
    "client": {
      "type": "object",
      "required": ["id", "name", "short_name", "timezone"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z0-9_-]+$",
          "description": "Unique client identifier (lowercase, underscores, hyphens allowed)"
        },
        "name": {
          "type": "string",
          "description": "Full company name"
        },
        "short_name": {
          "type": "string",
          "pattern": "^[a-z]+$",
          "description": "Short name (lowercase letters only)"
        },
        "timezone": {
          "type": "string",
          "description": "IANA timezone (e.g., America/New_York)"
        },
        "currency": {
          "type": "string",
          "pattern": "^[A-Z]{3}$",
          "default": "USD",
          "description": "ISO currency code"
        }
      }
    },
    "branding": {
      "type": "object",
      "properties": {
        "company_name": {
          "type": ["string", "null"]
        },
        "logo_url": {
          "type": ["string", "null"]
        },
        "primary_color": {
          "type": ["string", "null"]
        },
        "secondary_color": {
          "type": ["string", "null"]
        },
        "accent_color": {
          "type": ["string", "null"]
        },
        "theme_id": {
          "type": ["string", "null"]
        },
        "email_signature": {
          "type": ["string", "null"]
        }
      }
    },
    "destinations": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "code", "enabled"],
        "properties": {
          "name": {
            "type": "string"
          },
          "code": {
            "type": "string",
            "pattern": "^[A-Z0-9_]+$"
          },
          "enabled": {
            "type": "boolean"
          }
        }
      }
    },
    "infrastructure": {
      "type": "object",
      "required": ["gcp", "supabase", "openai"],
      "properties": {
        "gcp": {
          "type": "object",
          "required": ["project_id", "region", "dataset"],
          "properties": {
            "project_id": {
              "type": "string"
            },
            "region": {
              "type": "string"
            },
            "dataset": {
              "type": "string",
              "description": "Tenant-specific dataset for quotes, analytics, etc."
            },
            "shared_pricing_dataset": {
              "type": ["string", "null"],
              "default": "africastay_analytics",
              "description": "Shared dataset for hotel rates, pricing, flight data (all tenants use same)"
            },
            "corpus_id": {
              "type": ["string", "null"]
            }
          }
        },
        "supabase": {
          "type": "object",
          "required": ["url", "anon_key"],
          "properties": {
            "url": {
              "type": "string"
            },
            "anon_key": {
              "type": "string"
            },
            "service_key": {
              "type": ["string", "null"]
            }
          }
        },
        "vapi": {
          "type": "object",
          "properties": {
            "api_key": {
              "type": ["string", "null"]
            },
            "phone_number_id": {
              "type": ["string", "null"]
            },
            "assistant_id": {
              "type": ["string", "null"]
            },
            "outbound_assistant_id": {
              "type": ["string", "null"]
            }
          }
        },
        "openai": {
          "type": "object",
          "required": ["api_key"],
          "properties": {
            "api_key": {
              "type": "string"
            },
            "model": {
              "type": "string",
              "default": "gpt-4o-mini"
            }
          }
        }
      }
    },
    "email": {
      "type": "object",
      "required": ["primary", "smtp", "imap"],
      "properties": {
        "primary": {
          "type": "string"
        },
        "smtp": {
          "type": "object",
          "required": ["host", "port", "username"],
          "properties": {
            "host": {
              "type": "string"
            },
            "port": {
              "type": "integer"
            },
            "username": {
              "type": "string"
            },
            "password": {
              "type": ["string", "null"]
            }
          }
        },
        "imap": {
          "type": "object",
          "required": ["host", "port"],
          "properties": {
            "host": {
              "type": "string"
            },
            "port": {
              "type": "integer"
            }
          }
        },
        "sendgrid": {
          "type": "object",
          "properties": {
            "api_key": {
              "type": ["string", "null"]
            },
            "from_email": {
              "type": ["string", "null"]
            },
            "from_name": {
              "type": ["string", "null"]
            },
            "reply_to": {
              "type": ["string", "null"]
            }
          }
        }
      }
    },
    "outbound": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "timing": {
          "type": ["string", "null"]
        },
        "call_window": {
          "type": "object"
        },
        "call_days": {
          "type": "array"
        },
        "max_attempts": {
          "type": "integer"
        },
        "min_quote_value": {
          "type": "number"
        }
      }
    },
    "quotes": {
      "type": "object",
      "properties": {
        "auto_send": {
          "type": "boolean"
        },
        "validity_days": {
          "type": "integer"
        },
        "follow_up_days": {
          "type": "integer"
        }
      }
    },
    "consultants": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "name", "email", "active"],
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "active": {
            "type": "boolean"
          }
        }
      }
    },
    "agents": {
      "type": "object",
      "properties": {
        "inbound": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "name": {
              "type": ["string", "null"]
            },
            "voice_id": {
              "type": ["string", "null"]
            },
            "prompt_file": {
              "type": ["string", "null"]
            }
          }
        },
        "helpdesk": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "prompt_file": {
              "type": ["string", "null"]
            }
          }
        },
        "outbound": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "name": {
              "type": ["string", "null"]
            },
            "voice_id": {
              "type": ["string", "null"]
            },
            "prompt_file": {
              "type": ["string", "null"]
            }
          }
        }
      }
    },
    "knowledge_base": {
      "type": "object",
      "properties": {
        "categories": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}
