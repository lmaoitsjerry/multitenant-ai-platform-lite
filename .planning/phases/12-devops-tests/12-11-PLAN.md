---
phase: 12-devops-tests
plan: 11
type: execute
wave: 6
depends_on: ["12-09", "12-10"]
files_modified:
  - tests/test_admin_routes.py
  - tests/test_notifications_routes.py
  - tests/test_settings_routes.py
  - tests/test_users_routes.py
autonomous: true

must_haves:
  truths:
    - "Admin routes have endpoint tests"
    - "Notification routes have endpoint tests"
    - "Settings routes have endpoint tests"
    - "User routes have endpoint tests"
    - "Coverage increases by at least 8%"
  artifacts:
    - path: "tests/test_admin_routes.py"
      provides: "Admin route tests"
      min_lines: 150
    - path: "tests/test_notifications_routes.py"
      provides: "Notification tests"
      min_lines: 120
    - path: "tests/test_settings_routes.py"
      provides: "Settings tests"
      min_lines: 100
    - path: "tests/test_users_routes.py"
      provides: "User tests"
      min_lines: 120
---

<objective>
Add tests for admin, notifications, settings, and user routes.

Purpose: These routes handle administrative functions, user management, and notifications. Combined ~880 uncovered lines.

Output: 490+ lines of tests, ~8% coverage increase.
</objective>

<context>
@.planning/STATE.md
@src/api/admin_routes.py
@src/api/notifications_routes.py
@src/api/settings_routes.py
@src/api/users_routes.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create admin routes tests</name>
  <files>tests/test_admin_routes.py</files>
  <action>
Create tests for admin-only endpoints.

Key endpoints:
- GET /api/v1/admin/tenants
- GET /api/v1/admin/stats
- POST /api/v1/admin/broadcast

Test admin token validation. Target: 150+ lines.
  </action>
  <verify>
pytest tests/test_admin_routes.py -v
  </verify>
  <done>
test_admin_routes.py created.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create notifications routes tests</name>
  <files>tests/test_notifications_routes.py</files>
  <action>
Create tests for notification endpoints.

Key endpoints:
- GET /api/v1/notifications
- POST /api/v1/notifications/read
- DELETE /api/v1/notifications/{id}

Target: 120+ lines.
  </action>
  <verify>
pytest tests/test_notifications_routes.py -v
  </verify>
  <done>
test_notifications_routes.py created.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create settings routes tests</name>
  <files>tests/test_settings_routes.py</files>
  <action>
Create tests for settings endpoints.

Key endpoints:
- GET /api/v1/settings
- PUT /api/v1/settings
- GET /api/v1/settings/team

Target: 100+ lines.
  </action>
  <verify>
pytest tests/test_settings_routes.py -v
  </verify>
  <done>
test_settings_routes.py created.
  </done>
</task>

<task type="auto">
  <name>Task 4: Create users routes tests</name>
  <files>tests/test_users_routes.py</files>
  <action>
Create tests for user management endpoints.

Key endpoints:
- GET /api/v1/users
- POST /api/v1/users
- PUT /api/v1/users/{id}
- DELETE /api/v1/users/{id}

Target: 120+ lines.
  </action>
  <verify>
pytest tests/test_users_routes.py -v
  </verify>
  <done>
test_users_routes.py created.
  </done>
</task>

</tasks>

<verification>
- [ ] All test files created
- [ ] All tests pass
- [ ] Coverage approaches 58%
</verification>

<success_criteria>
1. Admin and user management routes tested
2. Coverage increasing toward target
</success_criteria>

<output>
After completion, create `.planning/phases/12-devops-tests/12-11-SUMMARY.md`
</output>
